---
import client from '@/lib/client'

import Tweet from './Tweet.astro'

interface Props extends astroHTML.JSX.HTMLAttributes {
  tweetId: string
}

const { tweetId, class: className, ...restProps } = Astro.props

let data = null
try {
  const response = await client.api['tweet-content'][':id'].$get({
    param: { id: tweetId }
  })
  data = response.status === 200 ? (await response.json()).tweet : null
} catch (err) {
  // Ignore fetch errors during prerender or network failures; render nothing.
  data = null
}
---
{data ? (
  <div class:list={['not-prose flex', className]} {...restProps}>
    <Tweet tweet={data} />
  </div>
) : null}
